description = 'Database creation'

apply plugin: 'java'
apply plugin: 'org.flywaydb.flyway'


buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath 'org.postgresql:postgresql:9.4-1201-jdbc41'
        classpath 'org.flywaydb:flyway-gradle-plugin:3.2.1'
    }
}

flyway {
    //          jdbc:postgresql://localhost:5432/squonk'
    url =      'jdbc:postgresql://' +
            (System.getenv('SQUONK_DB_SERVER') ?: 'localhost') + ':' +
            (System.getenv('SQUONK_DB_PORT') ?: '5432') + '/' +
            (System.getenv('SQUONK_DB_NAME') ?: 'squonk')
    user =     System.getenv('POSTGRES_USER') ?: 'postgres'
    password = System.getenv('POSTGRES_PASSWORD') ?: 'postgres'
    schemas = ['users']
    println "Using DB URL of $url and password of " + (System.getenv('POSTGRES_PASSWORD') ?: 'postgres')
}


